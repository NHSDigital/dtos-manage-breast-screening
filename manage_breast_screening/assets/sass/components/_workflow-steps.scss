// app/assets/sass/components/_workflow.scss

@use "../vendor/nhsuk-frontend/base" as *;

// Wider container for workflow mode
.nhsuk-width-container--wide {
  @include nhsuk-width-container(1200px);
}

// Use flexbox for workflow layout to allow nav column to stretch for sticky positioning
.app-workflow-container__row {
  @include nhsuk-media-query($from: desktop) {
    display: flex;
  }
}

.app-workflow-container__sidebar,
.app-workflow-container__main {
  @include nhsuk-media-query($from: desktop) {
    float: none;
  }
}

// Wrapper needs to fill the column height for sticky to work
.app-workflow-side-nav-wrapper {
  height: 100%;
}

.app-workflow-side-nav {
  position: sticky;
  top: nhsuk-spacing(4);
  padding-bottom: 15px;
}

.app-workflow-side-nav__heading {
  margin-bottom: nhsuk-spacing(3);
}

.app-workflow-side-nav__list {
  list-style: none;
  margin: 0;
  padding: 0;
}

.app-workflow-side-nav__item {
  position: relative;
  border-left: 4px solid transparent;
  margin-left: -1px;
}

.app-workflow-side-nav__step {
  @include nhsuk-font($size: 16);

  display: flex;
  align-items: center;
  gap: nhsuk-spacing(2);
  padding: nhsuk-spacing(2) 0 nhsuk-spacing(2) nhsuk-spacing(2);
  text-decoration: none;
  position: relative;
}

// Only apply link styles to actual links
a.app-workflow-side-nav__step {
  @include nhsuk-link-style-default;
  @include nhsuk-link-style-no-visited-state;

  &:hover {
    .app-workflow-side-nav__label {
      text-decoration: underline;
    }
  }

  &:focus {
    @include nhsuk-focused-text;
  }
}

.app-workflow-side-nav__step--disabled {
  color: $nhsuk-secondary-text-colour;
  cursor: not-allowed;
  pointer-events: none;
}

// Clickable links (not current, not completed, not disabled) have blue circles
.app-workflow-side-nav__step--clickable {
  .app-workflow-side-nav__number {
    background-color: nhsuk-colour("blue");
    color: nhsuk-colour("white");
  }
}

.app-workflow-side-nav__number {
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 0 0 nhsuk-px-to-rem(24px);
  width: nhsuk-px-to-rem(24px);
  height: nhsuk-px-to-rem(24px);
  background-color: nhsuk-colour("grey-4");
  color: nhsuk-colour("grey-1");
  border-radius: 50%;
  font-weight: 600;
  @include nhsuk-font-size(14);
  text-align: center;
  line-height: 1;

  .app-icon--tick {
    width: 16px;
    height: 16px;

    path {
      fill: nhsuk-colour("white");
      stroke: nhsuk-colour("white");
      stroke-width: 1;
    }
  }
}

a.app-workflow-side-nav__step:focus .app-workflow-side-nav__number {
  background-color: nhsuk-colour("black");
  color: nhsuk-colour("yellow");

  .app-icon--tick {
    path {
      fill: nhsuk-colour("yellow");
      stroke: nhsuk-colour("yellow");
    }
  }
}

.app-workflow-side-nav__label {
  flex: 1;
}

// Item states
.app-workflow-side-nav__item--current {
  border-left-color: $nhsuk-brand-colour;

  .app-workflow-side-nav__step {
    color: $nhsuk-text-colour;
  }

  .app-workflow-side-nav__label {
    font-weight: bold;
  }

  .app-workflow-side-nav__number {
    background-color: nhsuk-colour("blue");
    color: nhsuk-colour("white");
  }
}

.app-workflow-side-nav__item--completed {
  .app-workflow-side-nav__step--clickable .app-workflow-side-nav__number,
  .app-workflow-side-nav__number {
    background-color: nhsuk-colour("green");
    color: nhsuk-colour("white");
  }
}

.app-workflow-side-nav__item--disabled {
  .app-workflow-side-nav__step--clickable .app-workflow-side-nav__number,
  .app-workflow-side-nav__number {
    background-color: nhsuk-colour("grey-4");
    color: nhsuk-colour("grey-1");
  }
}

// Responsive - use full width on mobile
@media (max-width: 768px) {
  .app-workflow-side-nav {
    position: static;
  }
}
