{% extends 'workflow_step.jinja' %}
{% from "nhsuk/components/card/macro.jinja" import card %}
{% from "nhsuk/components/summary-list/macro.jinja" import summaryList %}
{% from "components/participant-details/summary_list_rows.jinja" import ethnicity_html %}
{% from "mammograms/check_information/appointment_details_card.jinja" import appointment_details_card %}
{% from "mammograms/check_information/images_taken_card.jinja" import images_taken_card %}
{% from "mammograms/check_information/medical_information_card.jinja" import medical_information_card %}

{% set active_workflow_step = 'CHECK_INFORMATION' %}

{% block step_content %}
  <p>Before concluding this appointment, confirm that the information recorded is correct.</p>

  {% call card({
  "heading": "Personal Information",
  "feature": true
  }) %}

  {{ summaryList({
      "rows": [
      {
          "key": {
              "text": "Ethnicity"
          },
          "value" : {
              "text": ethnicity_html(presented_appointment.participant) | default("Not provided", true) 
          }
      }
      ]
  }) }}

  {% endcall %}

  {{ medical_information_card(presented_medical_information) }}
  {{ images_taken_card(presented_images) }}
  {{ appointment_details_card(presented_appointment) }}

  <p>
    <a class="nhsuk-link nhsuk-link--no-visited-state" href="{{ appointment_cannot_proceed_href }}">Appointment cannot proceed</a>
  </p>

{% endblock %}


{% block wizard_form %}
  <form action="{{ url('mammograms:complete_screening', kwargs={'pk': presented_appointment.pk}) }}" method="post" novalidate>
    {{ csrf_input }}
    {{ button({
      "text": "Complete screening and return to clinic",
      "classes": "nhsuk-u-margin-bottom-4"
    }) }}
  </form>
{% endblock %}
